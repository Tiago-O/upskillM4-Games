<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Jogo memória</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Ubuntu', sans-serif;
            font-weight: 300;
        }

        body {
            background-image: linear-gradient(315deg, #bf3a30 0%, #864ba2 74%);
            height: 100vh;
            width: 100%;
            margin: 0;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }

        h1, h2, h3 {
            font-weight: 400;
        }

        h1 {
            font-size: 3.0em;
            color: #f6c333;
            text-shadow: 0 0 30px #0000FF , 0 0 10px #FF0000;
            text-align: center;
            font-weight: 500;
            transition: .2s ease-in-out 0s;
            cursor: pointer;
        }

        h1:hover {
            color: #f1e5b5;
        }

        h2 {
            color: #f6c333;
            font-size: 1.5em;
            text-align: center;
            font-weight: 400;
        }

        h3, h4 {
            color: #f1e5b5;
            font-size: 1em;
            text-align: center;
            margin: 0;
        }

        form {
            background-image: linear-gradient(hsl(225, 97%, 26%, 45%), transparent);
            color: #f1e5b5;
            margin: 3.5em 30em;
            padding: 3em;
            text-align: center;
            display: flex;
            align-items: center;
            flex-direction: column;
        }

        form > div {
            margin: 1em;
        }

        form > div > div {
            margin: 0.5em;
        }

        form > div > label {
            font-size: 1.5em;
            font-weight: 400;
            color:#f6c333;
        }

        button {
            height: 2.5em;
            align-items: center;
            background-color: #f6c333;
            color: hsl(225, 97%, 26%);
            border: 0;
            border-radius: 12px;
            box-sizing: border-box;
            cursor: pointer;
            font-size: 1em;
            padding-left: 1.5em;
            padding-right: 1.5em;
            text-decoration: none;
            text-transform: uppercase;
            transition: .2s ease-in-out 0s;
            font-weight: 400;
        }

        button:hover {
            transform: scale(1.05);
            /*background: #f6c333;
            cor: #f1e5b5;*/
        }

        #grid-container {
            display: flex;
            /*flex-direction: row;*/
            justify-content: center;
            flex-wrap: wrap;
            padding-left: 20em;
            padding-right: 20em;
            cursor: pointer;
        }

        .grid-card {
            flex: 1 0 20%;
            background-color: #f6c333;
            filter: drop-shadow(0 0 0.75rem hsl(225, 97%, 26%, 45%));
            border-radius: 12px;
            margin: 1em;
            height: 7.5rem;
            transition: .2s ease-in-out 0s;

            
        }

        .grid-card:hover {
            transform: scale(1.05);
            filter: drop-shadow(0 0 0.75rem crimson);
            background-color: #f1e5b5;
        }

        svg {
            color: #864ba2;
            margin: 0.5em;
        }
</style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Memory Game</h1>
    <div>
        <form>

            <div>
                <label>Who is playing?</label><br>
                <div>
                    <input type="text" required placeholder="Name" id="playerName"><br>
                </div>
            </div>

            <div>
                <label>Difficulty</label><br>
                <div>
                    <input type="radio" id="easy" name="level" value="easy" class="level">
                    <label for="easy">Easy 3 x 4</label>
                </div>
                <div>
                    <input type="radio" id="medium" name="level" value="medium" class="level">
                    <label for="medium">Medium 4 x 4</label>
                </div>
                <div>
                    <input type="radio" id="advanced" name="level" value="advanced" class="level">
                    <label for="advanced">Advanced 4 x 5</label>
                </div>
            </div>

            <!-- <button type="button" class="level" value="easy">Easy 3 x 4</button><br>
            <button type="button" class="level" value="medium">Medium 4 x 4</button><br>
            <button type="button" class="level" value="advanced">Advanced 4 x 5</button><br> -->

            <button type="button" id="startButton">Play!</button>
        </form>
    </div>
</body>

<script>
    let startButton = $('#startButton');
    let playerName = $('#playerName');
    let body = $('body');
    //let level = $('.level');

    let cardValues = [];

    // ### Read input values and display results
    startButton.click(function() {
        let playerNameValue = playerName.val();
        let levelValue = document.querySelector('input[name="level"]:checked').value // TODO: confirm if it's the best way to do it.
        let formValidity = true;

        // ## Check form validity
        /*if(!(playerNameValue[0].checkValidity() || levelValue[0].checkValidity())) {
            nome.addClass("is-invalid");
            formValidity = false;
        }*/

        if(formValidity) {
            body.append(`<div>
                <h2>Welcome ${playerNameValue}!</h2>
                <h3>Current level:</h3>
                <h4>${levelValue}</h4>
            </div>`)

            // # Clear input:
            playerName.val('');
            // TODO: disabled button.

            // # Create cards values:
            setRandomCardValues(levelValue, getCardsRows(levelValue), getCardsColumns(levelValue));

            // # Show cards:
            displayCards(getCardsRows(levelValue), getCardsColumns(levelValue));
        }
    })

    // ### Create and display cards grid dynamically

    // * easy: 3 rows x 4 columns
    // * medium: 4 rows x 4 columns
    // * advanced: 4 rows x 5 columns

    // ## Display cards
    function displayCards(rows, columns) {

        body.append(`<div id="grid-container"></div>`)
        let grid = $('#grid-container');

        /*let t = document.getElementById("titulo");
        let b = document.body;
        let x = 16;

        t.onclick = function(e){
            //console.log(e.target.style.fontSize) // Imprime "16 px"
            x++;
            t.style.fontSize = `${x}px`;
            //console.log(e.target.style.fontSize);
        }

        b.onclick = function(){
            const randomColor = Math.floor(Math.random()*16777215).toString(16);
            b.style.backgroundColor = "#" + randomColor;
        }*/

        for (let r = 0; r < rows; r++) {
            //grid.append(`<div class="grid-row">`)
            for (let c = 0; c < columns; c++) {
                let cell = $(`<div class="grid-card">
                    <!-- Card ${r} ${c} -->
                </div>`);

                //  # Show card value
                cell.click(function(){
                    //let cellWidth = cell.style.margin;
                    //cell.innerHTML = `${cardValues[c][r]}`;
                    //console.log(cellWidth);
                    //console.log(cardValues[r][c]);
                    insertCardIcons(r, c, cell)
                });

                grid.append(cell)
            }
            grid.append(`</div>`)
        }
    }

    // # Card icons
    function insertCardIcons(r, c, cell) {
        switch (cardValues[r][c]) {
            case(0): // Rocket
                cell.append(`<svg xmlns="http://www.w3.org/2000/svg" className="icon icon-tabler icon-tabler-rocket" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                                 stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M4 13a8 8 0 0 1 7 7a6 6 0 0 0 3 -5a9 9 0 0 0 6 -8a3 3 0 0 0 -3 -3a9 9 0 0 0 -8 6a6 6 0 0 0 -5 3"></path>
                                <path d="M7 14a6 6 0 0 0 -3 6a6 6 0 0 0 6 -3"></path>
                                <circle cx="15" cy="9" r="1"></circle>
                            </svg>`)
                break
            case(1): // Bat
                cell.append(`<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-bat" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M17 16c.74 -2.286 2.778 -3.762 5 -3c-.173 -2.595 .13 -5.314 -2 -7.5c-1.708 2.648 -3.358 2.557 -5 2.5v-4l-3 2l-3 -2v4c-1.642 .057 -3.292 .148 -5 -2.5c-2.13 2.186 -1.827 4.905 -2 7.5c2.222 -.762 4.26 .714 5 3c2.593 0 3.889 .952 5 4c1.111 -3.048 2.407 -4 5 -4z"></path>
                                <path d="M9 8a3 3 0 0 0 6 0"></path>
                            </svg>`)
                break
            case(2): // Ray
                cell.append(`<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-bolt" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <polyline points="13 3 13 10 19 10 11 21 11 14 5 14 13 3"></polyline>
                            </svg>`)
                break
            case(3): // Bow and arrow
                cell.append(`<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-bow" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M17 3h4v4"></path>
                                <path d="M21 3l-15 15"></path>
                                <path d="M3 18h3v3"></path>
                                <path d="M16.5 20c1.576 -1.576 2.5 -4.095 2.5 -6.5c0 -4.81 -3.69 -8.5 -8.5 -8.5c-2.415 0 -4.922 .913 -6.5 2.5l12.5 12.5z"></path>
                            </svg>`)
                break
            case(4): // Bug
                cell.append(`<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-bug" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M9 9v-1a3 3 0 0 1 6 0v1"></path>
                                <path d="M8 9h8a6 6 0 0 1 1 3v3a5 5 0 0 1 -10 0v-3a6 6 0 0 1 1 -3"></path>
                                <line x1="3" y1="13" x2="7" y2="13"></line>
                                <line x1="17" y1="13" x2="21" y2="13"></line>
                                <line x1="12" y1="20" x2="12" y2="14"></line>
                                <line x1="4" y1="19" x2="7.35" y2="17"></line>
                                <line x1="20" y1="19" x2="16.65" y2="17"></line>
                                <line x1="4" y1="7" x2="7.75" y2="9.4"></line>
                                <line x1="20" y1="7" x2="16.25" y2="9.4"></line>
                            </svg>`)
                break
            case(5): // Castle
                cell.append(`<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-building-castle" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M15 19v-2a3 3 0 0 0 -6 0v2a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-14h4v3h3v-3h4v3h3v-3h4v14a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z"></path>
                                <line x1="3" y1="11" x2="21" y2="11"></line>
                            </svg>`)
                break
            case(6): // Cactus
                cell.append(`<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-cactus" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M6 9v1a3 3 0 0 0 3 3h1"></path>
                                <path d="M18 8v5a3 3 0 0 1 -3 3h-1"></path>
                                <path d="M10 21v-16a2 2 0 1 1 4 0v16"></path>
                                <path d="M7 21h10"></path>
                            </svg>`)
                break
            case(7): // Candy
                cell.append(`<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-candy" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M7.05 11.293l4.243 -4.243a2 2 0 0 1 2.828 0l2.829 2.83a2 2 0 0 1 0 2.828l-4.243 4.243a2 2 0 0 1 -2.828 0l-2.829 -2.831a2 2 0 0 1 0 -2.828z"></path>
                                <path d="M16.243 9.172l3.086 -.772a1.5 1.5 0 0 0 .697 -2.516l-2.216 -2.217a1.5 1.5 0 0 0 -2.44 .47l-1.248 2.913"></path>
                                <path d="M9.172 16.243l-.772 3.086a1.5 1.5 0 0 1 -2.516 .697l-2.217 -2.216a1.5 1.5 0 0 1 .47 -2.44l2.913 -1.248"></path>
                            </svg>`)
                break
            case(8): // Pine tree
                cell.append(`<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-christmas-tree" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M12 3l4 4l-2 1l4 4l-3 1l4 4h-14l4 -4l-3 -1l4 -4l-2 -1z"></path>
                                <path d="M14 17v3a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1v-3"></path>
                            </svg>`)
                break
            case(9): // Web
                cell.append(`<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chart-radar" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M12 3l9.5 7l-3.5 11h-12l-3.5 -11z"></path>
                                <path d="M12 7.5l5.5 4l-2.5 5.5h-6.5l-2 -5.5z"></path>
                                <path d="M2.5 10l9.5 3l9.5 -3"></path>
                                <path d="M12 3v10l6 8"></path>
                                <path d="M6 21l6 -8"></path>
                            </svg>`)
                break
        }
    }

    // # Get rows
    function getCardsRows(levelValue) {

        let rows = 4;

        if(levelValue === 'easy') {
            rows = 3;
        }
        return rows;
    }

    // # Get columns
    function getCardsColumns(levelValue) {

        let columns = 4;

        if(levelValue === 'advanced'){
            columns = 5;
        }
        return columns;
    }

    // ### Random card values
    function setRandomCardValues(levelValue, rows, columns) {

        // * easy: 6 card types
        // * medium: 8 card types
        // * advanced: 10 card types

        let counterValues = []; // maximum 2 values of the same type
        let totalTypes = [];

        if(levelValue ==='easy') {
            totalTypes.length = 6;
        } else if(levelValue === 'medium') {
            totalTypes.length = 8;
        } else if(levelValue === 'advanced') {
            totalTypes.length = 10;
        }

        // Reset
        for (let i = 0; i < totalTypes.length; i++) {
            counterValues[i] = 0;
            totalTypes[i] = i;
        }

        for (let r = 0; r < rows; r++) {
                cardValues[r] = [];
            for (let c = 0; c < columns; c++) {
                cardValues[r][c] = randomCardValue(totalTypes)
                //console.log(cardValues[r][c]);
                counterValues[cardValues[r][c]]++ // Increment counter values
                if(counterValues[cardValues[r][c]] >= 2 ) {
                    totalTypes = totalTypes.filter(function(value) {
                        return value !== cardValues[r][c]; // Remove type value
                    })
                }
                //console.log(totalTypes)
            }
        }
        console.log(cardValues)
    }

    // ## Return random value between 0 and totalTypes.length
    function randomCardValue(totalTypes) {
        return totalTypes[Math.floor( Math.random() * totalTypes.length)];
    }


    //currentCardSelection.click(function() {

    //}

    // Dúvida: adicionar valor do simbolo. Qual a melhor maneira de atribuir?
</script>

</html>