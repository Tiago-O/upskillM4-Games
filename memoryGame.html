<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Jogo memória</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Ubuntu', sans-serif;
            font-weight: 300;
        }

        body {
            background-image: linear-gradient(315deg, #bf3a30 0%, #864ba2 74%);
            height: 100vh;
            width: 100%;
            margin: 0;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }

        h1, h2, h3 {
            font-weight: 400;
        }

        h1 {
            font-size: 3.0em;
            color: #f6c333;
            text-shadow: 0 0 30px #0000FF , 0 0 10px #FF0000;
            text-align: center;
            font-weight: 500;
            transition: .2s ease-in-out 0s;
            cursor: pointer;
        }

        h1:hover {
            color: #f1e5b5;
        }

        h2 {
            color: #f6c333;
            font-size: 1.5em;
            text-align: center;
            font-weight: 400;
        }

        h3, h4 {
            color: #f1e5b5;
            font-size: 1em;
            text-align: center;
            margin: 0;
        }

        form {
            background-image: linear-gradient(hsl(225, 97%, 26%, 45%), transparent);
            color: #f1e5b5;
            margin: 3.5em 30em;
            padding: 3em;
            text-align: center;
            display: flex;
            align-items: center;
            flex-direction: column;
        }

        form > div {
            margin: 1em;
        }

        form > div > div {
            margin: 0.5em;
        }

        form > div > label {
            font-size: 1.5em;
            font-weight: 400;
            color:#f6c333;
        }

        button {
            height: 2.5em;
            align-items: center;
            background-color: #f6c333;
            color: hsl(225, 97%, 26%);
            border: 0;
            border-radius: 12px;
            box-sizing: border-box;
            cursor: pointer;
            font-size: 1em;
            padding-left: 1.5em;
            padding-right: 1.5em;
            text-decoration: none;
            text-transform: uppercase;
            transition: .2s ease-in-out 0s;
            font-weight: 400;
        }

        button:hover {
            transform: scale(1.05);
            /*background: #f6c333;
            cor: #f1e5b5;*/
        }

        #grid-container {
            display: flex;
            /*flex-direction: row;*/
            justify-content: center;
            flex-wrap: wrap;
            padding-left: 20em;
            padding-right: 20em;
            cursor: pointer;
        }

        .grid-card {
            flex: 1 0 20%;
            background-color: #f6c333;
            filter: drop-shadow(0 0 0.75rem hsl(225, 97%, 26%, 45%));
            border-radius: 12px;
            margin: 1em;
            height: 7.5rem;
            transition: .2s ease-in-out 0s;

            
        }

        .grid-card:hover {
            transform: scale(1.05);
            filter: drop-shadow(0 0 0.75rem crimson);
            background-color: #f1e5b5;
        }
</style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Memory Game</h1>
    <div>
        <form>

            <div>
                <label>Who is playing?</label><br>
                <div>
                    <input type="text" required placeholder="Name" id="playerName"><br>
                </div>
            </div>

            <div>
                <label>Difficulty</label><br>
                <div>
                    <input type="radio" id="easy" name="level" value="easy" class="level">
                    <label for="easy">Easy 3 x 4</label>
                </div>
                <div>
                    <input type="radio" id="medium" name="level" value="medium" class="level">
                    <label for="medium">Medium 4 x 4</label>
                </div>
                <div>
                    <input type="radio" id="advanced" name="level" value="advanced" class="level">
                    <label for="advanced">Advanced 4 x 5</label>
                </div>
            </div>

            <!-- <button type="button" class="level" value="easy">Easy 3 x 4</button><br>
            <button type="button" class="level" value="medium">Medium 4 x 4</button><br>
            <button type="button" class="level" value="advanced">Advanced 4 x 5</button><br> -->

            <button type="button" id="startButton">Play!</button>
        </form>
    </div>
</body>

<script>
    let startButton = $('#startButton');
    let playerName = $('#playerName');
    let body = $('body');
    //let level = $('.level');

    let cardValues = [];

    // ### Read input values and display results
    startButton.click(function() {
        let playerNameValue = playerName.val();
        let levelValue = document.querySelector('input[name="level"]:checked').value // TODO: confirm if it's the best way to do it.
        let formValidity = true;

        // ## Check form validity
        /*if(!(playerNameValue[0].checkValidity() || levelValue[0].checkValidity())) {
            nome.addClass("is-invalid");
            formValidity = false;
        }*/

        if(formValidity) {
            body.append(`<div>
                <h2>Welcome ${playerNameValue}!</h2>
                <h3>Current level:</h3>
                <h4>${levelValue}</h4>
            </div>`)

            // # Clear input:
            playerName.val('');
            // TODO: disabled button.

            // # Create cards values:
            setRandomCardValues(levelValue, getCardsRows(levelValue), getCardsColumns(levelValue));

            // # Show cards:
            displayCards(getCardsRows(levelValue), getCardsColumns(levelValue));
        }
    })

    // ### Create and display cards grid dynamically

    // * easy: 3 rows x 4 columns
    // * medium: 4 rows x 4 columns
    // * advanced: 4 rows x 5 columns

    // ## Display cards
    function displayCards(rows, columns) {

        body.append(`<div id="grid-container"></div>`)
        let grid = $('#grid-container');
        for (let r = 0; r < rows; r++) {
            //grid.append(`<div class="grid-row">`)
            for (let c = 0; c < columns; c++) {
                let cell = $(`<div class="grid-card">
                    Card ${c} ${r}
                </div>`);
                //  # Show card value
                cell.click(function(){
                    //Fiquei aqui
                    //cell.innerHTML = `${cardValues[c][r]}`;
                    //console.log(cardValues[c][r]);
                });
                grid.append(cell)

            }
            grid.append(`</div>`)
        }
    }

    // # Get rows
    function getCardsRows(levelValue) {

        let rows = 4;

        if(levelValue === 'easy') {
            rows = 3;
        }
        return rows;
    }

    // # Get columns
    function getCardsColumns(levelValue) {

        let columns = 4;

        if(levelValue === 'advanced'){
            columns = 5;
        }
        return columns;
    }

    // ### Random card values
    function setRandomCardValues(levelValue, rows, columns) {

        // * easy: 6 card types
        // * medium: 8 card types
        // * advanced: 10 card types

        let counterValues = []; // maximum 2 values of the same type
        let totalTypes = [];

        if(levelValue ==='easy') {
            totalTypes.length = 6;
        } else if(levelValue === 'medium') {
            totalTypes.length = 8;
        } else if(levelValue === 'advanced') {
            totalTypes.length = 10;
        }

        // Reset
        for (let i = 0; i < totalTypes.length; i++) {
            counterValues[i] = 0;
            totalTypes[i] = i;
        }

        for (let r = 0; r < rows; r++) {
                cardValues[r] = [];
            for (let c = 0; c < columns; c++) {
                cardValues[r][c] = randomCardValue(totalTypes)
                //console.log(cardValues[r][c]);
                counterValues[cardValues[r][c]]++ // Increment counter values
                if(counterValues[cardValues[r][c]] >= 2 ) {
                    totalTypes = totalTypes.filter(function(value) {
                        return value !== cardValues[r][c]; // Remove type value
                    })
                }
                //console.log(totalTypes)
            }
        }
        console.log(cardValues)
    }

    // ## Return random value between 0 and totalTypes.length
    function randomCardValue(totalTypes) {
        return totalTypes[Math.floor( Math.random() * totalTypes.length)];
    }


    //currentCardSelection.click(function() {

    //}

    // Dúvida: adicionar valor do simbolo. Qual a melhor maneira de atribuir?
</script>

</html>